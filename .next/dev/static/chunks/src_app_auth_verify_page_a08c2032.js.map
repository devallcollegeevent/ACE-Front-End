{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Admin/Downloads/ace-nextjs-full-project/src/app/auth/verify/page.js"],"sourcesContent":["\"use client\";\r\n\r\nimport { useState, useRef } from \"react\";\r\nimport { useRouter, useSearchParams } from \"next/navigation\";\r\nimport { toast } from \"react-hot-toast\";\r\nimport \"@/app/auth/auth-common.css\";\r\n\r\n/* API */\r\nimport { verifyOtpApi, resendOtpApi } from \"@/lib/api/auth.api\";\r\n\r\n/* AUTH */\r\nimport { getEmail } from \"@/lib/auth\";\r\n\r\n/* VALIDATION */\r\nimport { otpSchema } from \"@/components/validation\";\r\n\r\n/* CONSTANTS */\r\nimport {\r\n  TITLE_ENTER_OTP,\r\n  SUB_TITLE_ENTER_OTP,\r\n  BTN_CONTINUE,\r\n  BTN_OTP_RESEND,\r\n  MSG_GENERIC_ERROR,\r\n  MSG_NEW_OTP_SEND,\r\n  MSG_NEW_OTP_FAILED_TO_SEND,\r\n  MSG_OTP_INVALID,\r\n  MSG_OTP_VERIFIED,\r\n  SUB_TITLE_OTP_NOT_RECEIVE,\r\n  CONDITION_OTP_VERIFY,\r\n  CONDITION_OTP_SEND,\r\n  ROLE_USER,\r\n} from \"@/const-value/config-message/page\";\r\n\r\nexport default function VerifyOtpPage() {\r\n  const router = useRouter();\r\n  const params = useSearchParams();\r\n  const role = params.get(\"role\") || ROLE_USER;\r\n\r\n  const email = getEmail();\r\n\r\n  const [otp, setOtp] = useState([\"\", \"\", \"\", \"\"]);\r\n  const [loading, setLoading] = useState(false);\r\n  const [resendLoading, setResendLoading] = useState(false);\r\n\r\n  const inputs = [\r\n    useRef(null),\r\n    useRef(null),\r\n    useRef(null),\r\n    useRef(null),\r\n  ];\r\n\r\n  /* ROLE CONFIG */\r\n  const config = {\r\n    user: {\r\n      image: \"/images/auth-forgot.png\",\r\n      redirect: \"/auth/reset-password?role=user\",\r\n    },\r\n    organizer: {\r\n      image: \"/images/or_forgotpassword.png\",\r\n      redirect: \"/auth/reset-password?role=organizer\",\r\n    },\r\n  };\r\n\r\n  const ui = config[role];\r\n\r\n  function onChange(index, value) {\r\n    if (!/^\\d*$/.test(value)) return;\r\n\r\n    const next = [...otp];\r\n    next[index] = value.slice(-1);\r\n    setOtp(next);\r\n\r\n    if (value && index < 3) {\r\n      inputs[index + 1].current?.focus();\r\n    }\r\n  }\r\n\r\n  async function onSubmit(e) {\r\n    e.preventDefault();\r\n    const code = otp.join(\"\");\r\n\r\n    try {\r\n      await otpSchema.validate({ otp: code }, { abortEarly: false });\r\n    } catch (err) {\r\n      return toast.error(err.errors[0]);\r\n    }\r\n\r\n    try {\r\n      setLoading(true);\r\n      const res = await verifyOtpApi({ email, otp: code });\r\n      setLoading(false);\r\n\r\n      if (res?.status) {\r\n        toast.success(MSG_OTP_VERIFIED);\r\n        router.push(ui.redirect);\r\n      } else {\r\n        toast.error(res?.message || MSG_OTP_INVALID);\r\n      }\r\n    } catch (err) {\r\n      setLoading(false);\r\n      toast.error(MSG_GENERIC_ERROR);\r\n    }\r\n  }\r\n\r\n  async function resendCode() {\r\n    try {\r\n      setResendLoading(true);\r\n      const res = await resendOtpApi({ email });\r\n      setResendLoading(false);\r\n\r\n      if (res?.status) {\r\n        toast.success(MSG_NEW_OTP_SEND);\r\n      } else {\r\n        toast.error(res?.message || MSG_NEW_OTP_FAILED_TO_SEND);\r\n      }\r\n    } catch (err) {\r\n      setResendLoading(false);\r\n      toast.error(MSG_GENERIC_ERROR);\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className=\"org-shell\">\r\n      {/* LEFT IMAGE */}\r\n      <aside className=\"org-left\">\r\n        <img className=\"org-left-img\" src={ui.image} alt=\"otp\" />\r\n      </aside>\r\n\r\n      {/* RIGHT CONTENT */}\r\n      <main className=\"org-right\">\r\n        <div className=\"org-card\">\r\n          <h2 className=\"org-title\">{TITLE_ENTER_OTP}</h2>\r\n          <div className=\"org-sub\">\r\n            {SUB_TITLE_ENTER_OTP} {email || \"your email\"}\r\n          </div>\r\n\r\n          <form className=\"org-form\" onSubmit={onSubmit}>\r\n            <div className=\"otp-row\">\r\n              {otp.map((val, i) => (\r\n                <input\r\n                  key={i}\r\n                  ref={inputs[i]}\r\n                  className=\"otp-input\"\r\n                  inputMode=\"numeric\"\r\n                  maxLength={1}\r\n                  value={val}\r\n                  onChange={(e) => onChange(i, e.target.value)}\r\n                />\r\n              ))}\r\n            </div>\r\n\r\n            <div className=\"form-actions\">\r\n              <button\r\n                className=\"btn-primary-ghost\"\r\n                type=\"submit\"\r\n                disabled={loading}\r\n              >\r\n                {loading ? CONDITION_OTP_VERIFY : BTN_CONTINUE}\r\n              </button>\r\n            </div>\r\n\r\n            <div className=\"org-foot\" style={{ marginTop: 10 }}>\r\n              {SUB_TITLE_OTP_NOT_RECEIVE}{\" \"}\r\n              <button\r\n                type=\"button\"\r\n                className=\"resendCondeText\"\r\n                onClick={resendCode}\r\n                disabled={resendLoading}\r\n              >\r\n                {resendLoading ? CONDITION_OTP_SEND : BTN_OTP_RESEND}\r\n              </button>\r\n            </div>\r\n          </form>\r\n        </div>\r\n      </main>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}}]
}