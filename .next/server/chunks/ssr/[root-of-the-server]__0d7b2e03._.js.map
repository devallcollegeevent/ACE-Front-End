{"version":3,"sources":["../../../../src/lib/axiosPublic.js","../../../../src/lib/api/auth.api.js","../../../../src/app/auth/enter-otp/page.js"],"sourcesContent":["import axios from \"axios\";\r\n\r\nconst apiPublic = axios.create({\r\n  baseURL: process.env.NEXT_PUBLIC_API_URL,\r\n});\r\n\r\nconsole.log(\"API BASE URL =>\", process.env.NEXT_PUBLIC_API_URL);\r\n\r\n\r\nexport default apiPublic;   \r\n","import apiPrivate from \"../axiosPrivate\";\r\nimport apiPublic from \"../axiosPublic\";\r\nimport { API_ENDPOINTS } from \"./endpoints\";\r\nimport { handleApi } from \"./apiHelper\";\r\n\r\n/* ================= AUTH ================= */\r\n\r\nexport const signupApi = (data) =>\r\n  handleApi(apiPublic.post(API_ENDPOINTS.AUTH.SIGNUP, data));\r\n\r\nexport const organizerSignupApi = signupApi;\r\n\r\nexport const loginApi = (data) =>\r\n  handleApi(apiPublic.post(API_ENDPOINTS.AUTH.LOGIN, data));\r\n\r\nexport const googleAuthLoginApi = (data) =>\r\n  handleApi(apiPublic.post(API_ENDPOINTS.AUTH.GOOGLE_LOGIN, data));\r\n\r\nexport const forgotApi = (data) =>\r\n  handleApi(apiPublic.post(API_ENDPOINTS.AUTH.FORGOT_PASSWORD, data));\r\n\r\nexport const verifyOtpApi = (data) =>\r\n  handleApi(apiPublic.post(API_ENDPOINTS.AUTH.VERIFY_OTP, data));\r\n\r\nexport const resendOtpApi = (data) =>\r\n  handleApi(apiPublic.post(API_ENDPOINTS.AUTH.RESEND_OTP, data));\r\n\r\nexport const resetPasswordApi = (data) =>\r\n  handleApi(apiPublic.post(API_ENDPOINTS.AUTH.RESET_PASSWORD, data));\r\n\r\nexport const verifyEmailApi = (token) =>\r\n  handleApi(\r\n    apiPublic.get(\r\n      `${API_ENDPOINTS.AUTH.ORG_VERIFY}?token=${encodeURIComponent(token)}`\r\n    )\r\n  );\r\n","\"use client\";\r\n\r\nimport { useState, useRef, useEffect } from \"react\";\r\nimport { useRouter, useSearchParams } from \"next/navigation\";\r\nimport { toast } from \"react-hot-toast\";\r\nimport \"./enter-otp.css\";\r\n\r\n/* VALIDATION */\r\nimport { otpSchema } from \"../../../components/validation\";\r\n\r\n/* API */\r\nimport { verifyOtpApi, resendOtpApi } from \"../../../lib/api/auth.api\";\r\n\r\n/* AUTH */\r\nimport { getEmail } from \"../../../lib/auth\";\r\n\r\n/* CONSTANTS */\r\nimport {\r\n  TITLE_ENTER_OTP,\r\n  SUB_TITLE_ENTER_OTP,\r\n  BTN_CONTINUE,\r\n  BTN_OTP_RESEND,\r\n  MSG_GENERIC_ERROR,\r\n  MSG_NEW_OTP_SEND,\r\n  MSG_NEW_OTP_FAILED_TO_SEND,\r\n  MSG_OTP_INVALID,\r\n  MSG_OTP_VERIFIED,\r\n  SUB_TITLE_OTP_NOT_RECEIVE,\r\n  CONDITION_OTP_VERIFY,\r\n  CONDITION_OTP_SEND,\r\n  ROLE_USER,\r\n} from \"../../../const-value/config-message/page\";\r\n\r\nexport default function VerifyOtpPage() {\r\n  const router = useRouter();\r\n  const params = useSearchParams();\r\n  const role = params.get(\"role\") || ROLE_USER;\r\n\r\n  const [email, setEmail] = useState(\"\");\r\n\r\n  useEffect(() => {\r\n    const storedEmail = getEmail();\r\n    if (storedEmail) setEmail(storedEmail);\r\n  }, []);\r\n\r\n  const [otp, setOtp] = useState([\"\", \"\", \"\", \"\"]);\r\n  const [loading, setLoading] = useState(false);\r\n  const [resendLoading, setResendLoading] = useState(false);\r\n\r\n  const inputs = [\r\n    useRef(null),\r\n    useRef(null),\r\n    useRef(null),\r\n    useRef(null),\r\n  ];\r\n\r\n  const config = {\r\n    user: {\r\n      image: \"/images/auth-forgot.png\",\r\n      redirect: \"/auth/reset-password?role=user\",\r\n    },\r\n    organizer: {\r\n      image: \"/images/or_forgotpassword.png\",\r\n      redirect: \"/auth/reset-password?role=organizer\",\r\n    },\r\n  };\r\n\r\n  const ui = config[role];\r\n\r\n  function onChange(index, value) {\r\n    if (!/^\\d*$/.test(value)) return;\r\n\r\n    const next = [...otp];\r\n    next[index] = value.slice(-1);\r\n    setOtp(next);\r\n\r\n    if (value && index < 3) {\r\n      inputs[index + 1].current?.focus();\r\n    }\r\n  }\r\n\r\n  async function onSubmit(e) {\r\n    e.preventDefault();\r\n    const code = otp.join(\"\");\r\n\r\n    try {\r\n      await otpSchema.validate({ otp: code }, { abortEarly: false });\r\n    } catch (err) {\r\n      return toast.error(err.errors[0]);\r\n    }\r\n\r\n    try {\r\n      setLoading(true);\r\n      const res = await verifyOtpApi({ email, otp: code });\r\n      setLoading(false);\r\n\r\n      if (res?.status) {\r\n        toast.success(MSG_OTP_VERIFIED);\r\n        router.push(ui.redirect);\r\n      } else {\r\n        toast.error(res?.message || MSG_OTP_INVALID);\r\n      }\r\n    } catch {\r\n      setLoading(false);\r\n      toast.error(MSG_GENERIC_ERROR);\r\n    }\r\n  }\r\n\r\n  async function resendCode() {\r\n    try {\r\n      setResendLoading(true);\r\n      const res = await resendOtpApi({ email });\r\n      setResendLoading(false);\r\n\r\n      if (res?.status) {\r\n        toast.success(MSG_NEW_OTP_SEND);\r\n      } else {\r\n        toast.error(res?.message || MSG_NEW_OTP_FAILED_TO_SEND);\r\n      }\r\n    } catch {\r\n      setResendLoading(false);\r\n      toast.error(MSG_GENERIC_ERROR);\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className=\"org-shell\">\r\n      <aside className=\"org-left\">\r\n        <img className=\"org-left-img\" src={ui.image} alt=\"otp\" />\r\n      </aside>\r\n\r\n      <main className=\"org-right\">\r\n        <div className=\"org-card\">\r\n          <h2 className=\"org-title\">{TITLE_ENTER_OTP}</h2>\r\n\r\n          <div className=\"org-sub\">\r\n            {SUB_TITLE_ENTER_OTP}{\" \"}\r\n            {email ? email : \"your email\"}\r\n          </div>\r\n\r\n          <form className=\"org-form\" onSubmit={onSubmit}>\r\n            <div className=\"otp-row\">\r\n              {otp.map((val, i) => (\r\n                <input\r\n                  key={i}\r\n                  ref={inputs[i]}\r\n                  className=\"otp-input\"\r\n                  maxLength={1}\r\n                  value={val}\r\n                  onChange={(e) => onChange(i, e.target.value)}\r\n                />\r\n              ))}\r\n            </div>\r\n\r\n            <div className=\"form-actions\">\r\n              <button\r\n                className=\"btn-primary-ghost\"\r\n                type=\"submit\"\r\n                disabled={loading}\r\n              >\r\n                {loading ? CONDITION_OTP_VERIFY : BTN_CONTINUE}\r\n              </button>\r\n            </div>\r\n\r\n            <div className=\"org-foot\" style={{ marginTop: 10 }}>\r\n              {SUB_TITLE_OTP_NOT_RECEIVE}{\" \"}\r\n              <button\r\n                type=\"button\"\r\n                className=\"resendCondeText\"\r\n                onClick={resendCode}\r\n                disabled={resendLoading}\r\n              >\r\n                {resendLoading ? CONDITION_OTP_SEND : BTN_OTP_RESEND}\r\n              </button>\r\n            </div>\r\n          </form>\r\n        </div>\r\n      </main>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}